<!DOCTYPE html>
<!--
 - Syncnapsis Framework - Copyright (c) 2012-2014 ultimate
 - 
 - This program is free software; you can redistribute it and/or modify it under the terms of
 - the GNU General Public License as published by the Free Software Foundation; either version
 - 3 of the License, or any later version.
 - 
 - This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
 - without even the implied warranty of MECHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 - See the GNU General Public License for more details.
 - 
 - You should have received a copy of the GNU General Plublic License along with this program;
 - if not, see <http://www.gnu.org/licenses/>.
-->
<html>
<head>
<link rel="stylesheet" type="text/css" href="styles/default.css" />
<link rel="stylesheet" type="text/css" href="styles/base.css" />
<link rel="stylesheet" type="text/css" href="styles/components.css" />
<link rel="stylesheet" type="text/css" href="styles/select.css" />
<script type="text/javascript" src="scripts/util/Events.js"></script>
<script type="text/javascript" src="scripts/select.js"></script>
<!--
<script type="text/javascript" src="scripts/lib/json2.js"></script>
<script type="text/javascript" src="scripts/util/Requests.js"></script>
<script type="text/javascript" src="scripts/util/Reflections.js"></script>
<script type="text/javascript" src="scripts/util/Arrays.js"></script>
<script type="text/javascript" src="scripts/util/Strings.js"></script>
<script type="text/javascript" src="scripts/styles.js"></script>
<script type="text/javascript" src="scripts/ui.js"></script>
<script type="text/javascript">
	var d;
	var w;
	test = function()
	{
		d = document.createElement("div");
		d.innerHTML = "Bla bla:<br><ul><li>abc</li><li>abc</li></ul>";
		
		w = new Styles.Window(1, "menu.login", d);
		
		w.setPosition(100, 100);
		w.setSize(300,200);
		w.setVisible(true);
	}
</script>
-->
<script type="text/javascript">
	var leftID = "left";
	var rightID = "right";
	
	add = function()
	{
		move(leftID, rightID);
	};
	
	remove = function()
	{
		move(rightID, leftID);
	};
	
	move = function(from, to)
	{
		if(typeof(from) == "string")
			from = document.getElementById(from);
		if(typeof(to) == "string")
			to = document.getElementById(to);
		
		for(var i = 0; i < from.children.length; i++)
		{
			if(children[i].classList.contains("selected"))
			{
				children[i].classList.remove("selected");
				to.appendChild(children[i]);
			}
		}
	};
	
	select = function(element, event)
	{
		console.log("select")
		if(Events.hasModifiers(event, Events.KEY_CTRL))
		{
			if(element.classList.contains("selected"))
				element.classList.remove("selected");
			else
				element.classList.add("selected");
		}
		else if(Events.hasModifiers(event, Events.KEY_SHIFT))
		{
			// select all from last to this
			var lastFound, thisFound;
			for(var i = 0; i <= element.parentElement.children.length; i++)
			{
				if(element.parentElement.children[i] == element.parentElement.lastSelected)
					lastFound = true;
				else if(element.parentElement.children[i] == element)
					thisFound = true;
				
				if(lastFound || thisFound)
					element.parentElement.children[i].classList.add("selected");
				else
					element.parentElement.children[i].classList.remove("selected");
				
				if(lastFound && thisFound)
					break;
			}
		}
		else
		{
			// deselect all others
			for(var i = 0; i < element.parentElement.children.length; i++)
			{
				element.parentElement.children[i].classList.remove("selected");
			}
			// select this one
			element.classList.add("selected");
		}
		element.parentElement.lastSelected = element;
	};
	
	init = function()
	{
		var left = document.getElementById(leftID);
		var right = document.getElementById(rightID);
		
		for(var i = 0; i < left.children.length; i++)
		{
			left.children[i].onclick = function(event)
			{
				select(this, event)
			};
		}
		for(var i = 0; i < right.children.length; i++)
		{
			right.children[i].onclick = function(event)
			{
				select(this, event)
			};
		}
	};
</script>
<style type="text/css">
	.container {
		flex-direction: row;
		display: flex;
	}
	.container>div {
		flex-grow: 1;
		border: 1px solid rgb(0,255,255);
		background-color: rgba(0,255,255,0.3);
	}
	.comboselect {
	}
	.comboselect .selected {
		background-color: rgba(0,255,255,0.9);
		color: black;
	}


</style>
</head>
<body onload="init();">
	
<div style="position: absolute; left: 200px; top: 200px; width: 300px; height: 200px" class="container">
	<div>
		<!-- left -->
		<ul class="comboselect" id="left">
			<li>foo</li>
			<li>bar</li>
			<li>baz</li>
		</ul>
	</div>
	<div>
		<input type="button" onclick="javascript: add();" value="add"><br/>
		<input type="button" onclick="javascript: remove();" value="remove">
	</div>
	<div>
		<!-- right -->
		<ul class="comboselect" id="right">
			<li>one</li>
			<li>two</li>
			<li>three</li>
		</ul>
	</div>
</div>
</body>
</html>